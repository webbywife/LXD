<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="auth-token" content="{{ auth_token }}">
<link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
<title>SKOOLED-AI ¬∑ Syllabus Generator</title>
<link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@300;400;500;600;700&family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0a1929;--nav:#0d1f2d;--card:rgba(255,255,255,0.05);
  --cyan:#00bbd6;--cyan-d:#009bb3;--orange:#faa32b;--green:#00b894;
  --red:#e74c3c;--white:#ffffff;--grey:rgba(255,255,255,0.6);
  --border:rgba(0,187,214,0.2);--rad:14px;--form-w:400px;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{font-family:'Plus Jakarta Sans',sans-serif;background:var(--bg);color:var(--white);min-height:100vh;display:flex;flex-direction:column;overflow:hidden;}
h1,h2,h3,h4{font-family:'Space Grotesk',sans-serif;}

/* ‚îÄ‚îÄ Nav ‚îÄ‚îÄ */
.nav{background:var(--nav);padding:0 24px;height:52px;display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid var(--border);position:sticky;top:0;z-index:200;flex-shrink:0;}
.nav-brand{font-family:'Space Grotesk',sans-serif;font-size:17px;font-weight:800;color:var(--white);letter-spacing:-0.03em;text-decoration:none;}
.nav-brand span{color:var(--cyan);}
.nav-links{display:flex;gap:6px;align-items:center;}
.nav-links a{color:var(--grey);text-decoration:none;font-size:12px;font-weight:500;padding:5px 12px;border-radius:8px;transition:.2s;}
.nav-links a:hover{color:var(--white);background:rgba(255,255,255,0.06);}
.nav-links a.active{color:var(--cyan);background:rgba(0,187,214,0.1);}
.nav-links .sep{color:rgba(255,255,255,0.15);font-size:16px;margin:0 2px;}
.nav-user{font-size:12px;color:var(--grey);padding:5px 12px;border-left:1px solid var(--border);margin-left:6px;}

/* ‚îÄ‚îÄ Layout ‚îÄ‚îÄ */
.layout{display:flex;flex:1;overflow:hidden;height:calc(100vh - 52px);}

/* ‚îÄ‚îÄ Form Panel ‚îÄ‚îÄ */
.form-panel{width:var(--form-w);min-width:320px;background:rgba(0,0,0,0.3);border-right:1px solid var(--border);overflow-y:auto;display:flex;flex-direction:column;flex-shrink:0;}
.form-inner{padding:20px;flex:1;}
.form-title{font-size:15px;font-weight:700;color:var(--white);margin-bottom:2px;letter-spacing:-0.02em;}
.form-sub{font-size:11px;color:var(--grey);margin-bottom:18px;}

/* Form Sections */
.fs{margin-bottom:18px;}
.fs-hdr{font-size:11px;font-weight:700;letter-spacing:.07em;text-transform:uppercase;color:var(--cyan);margin-bottom:10px;display:flex;align-items:center;gap:6px;}
.fs-hdr::after{content:'';flex:1;height:1px;background:var(--border);}

/* Type Tabs */
.type-tabs{display:grid;grid-template-columns:1fr 1fr;gap:6px;margin-bottom:10px;}
.type-tab{padding:9px 14px;border-radius:10px;border:1.5px solid var(--border);background:transparent;color:var(--grey);font-size:12px;font-weight:600;cursor:pointer;transition:.2s;text-align:center;font-family:'Space Grotesk',sans-serif;}
.type-tab:hover{border-color:var(--cyan);color:var(--white);}
.type-tab.on{border-color:var(--cyan);background:rgba(0,187,214,0.12);color:var(--white);}

/* Form Fields */
.fg{margin-bottom:10px;}
.fg label{display:block;font-size:11px;font-weight:600;color:rgba(255,255,255,0.7);margin-bottom:4px;}
.fg input,.fg select,.fg textarea{
  width:100%;padding:8px 12px;font-size:12px;font-family:inherit;
  border:1.5px solid rgba(0,187,214,0.25);border-radius:9px;
  background:rgba(255,255,255,0.06);color:var(--white);transition:.2s;
}
.fg input::placeholder,.fg textarea::placeholder{color:rgba(255,255,255,0.3);}
.fg input:focus,.fg select:focus,.fg textarea:focus{outline:none;border-color:var(--cyan);background:rgba(0,187,214,0.06);}
.fg select option{background:#0d1f2d;color:#fff;}
.fg textarea{resize:vertical;min-height:70px;line-height:1.6;}
.fg .hint{font-size:10px;color:var(--grey);margin-top:3px;line-height:1.4;}
.fr2{display:grid;grid-template-columns:1fr 1fr;gap:8px;}

/* Grading rows */
.grading-row{display:grid;grid-template-columns:1fr 60px;gap:6px;margin-bottom:6px;align-items:center;}
.grading-row input{padding:7px 10px;font-size:12px;}
.grading-total{font-size:12px;font-weight:700;color:var(--grey);text-align:right;padding-top:4px;}
.grading-total.ok{color:var(--green);}
.grading-total.err{color:var(--red);}

/* AI Settings */
.ai-toggle{display:flex;align-items:center;gap:10px;padding:10px 14px;border:1.5px solid var(--border);border-radius:10px;cursor:pointer;margin-bottom:8px;transition:.2s;}
.ai-toggle:hover{border-color:rgba(0,187,214,0.5);}
.ai-toggle.on{border-color:var(--cyan);background:rgba(0,187,214,0.07);}
.ai-toggle-ico{font-size:18px;flex-shrink:0;}
.ai-toggle-lbl{flex:1;font-size:12px;font-weight:600;}
.sw{position:relative;width:38px;height:20px;flex-shrink:0;}
.sw input{opacity:0;width:0;height:0;}
.sl{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(255,255,255,0.15);border-radius:20px;cursor:pointer;transition:.3s;}
.sl:before{content:"";position:absolute;height:14px;width:14px;left:3px;bottom:3px;background:#fff;border-radius:50%;transition:.3s;}
.sw input:checked+.sl{background:var(--cyan);}
.sw input:checked+.sl:before{transform:translateX(18px);}
.ai-fields{display:none;margin-top:8px;}
.ai-fields.on{display:block;}

/* Generate Button */
.form-foot{padding:16px 20px;border-top:1px solid var(--border);flex-shrink:0;}
.btn-gen{width:100%;padding:13px;border-radius:12px;border:none;background:var(--cyan);color:#000;font-size:14px;font-weight:800;font-family:'Space Grotesk',sans-serif;cursor:pointer;transition:.2s;letter-spacing:-0.02em;}
.btn-gen:hover{background:#00d4f0;box-shadow:0 6px 24px rgba(0,187,214,.35);}
.btn-gen:disabled{opacity:.5;cursor:not-allowed;}

/* ‚îÄ‚îÄ Output Panel ‚îÄ‚îÄ */
.output-panel{flex:1;overflow-y:auto;background:#e8eef2;display:flex;flex-direction:column;}
.output-toolbar{background:#fff;border-bottom:1px solid #dde5ea;padding:10px 20px;display:flex;align-items:center;justify-content:space-between;flex-shrink:0;gap:10px;}
.output-toolbar h3{font-size:13px;font-weight:700;color:#0d1f2d;margin:0;}
.ot-btns{display:flex;gap:8px;}
.btn-sm{padding:6px 14px;border-radius:8px;font-size:12px;font-weight:600;border:1.5px solid #c8e8ee;background:#fff;color:#0d1f2d;cursor:pointer;font-family:'Space Grotesk',sans-serif;transition:.2s;}
.btn-sm:hover{border-color:var(--cyan);color:var(--cyan);}
.btn-sm.primary{background:var(--cyan);color:#fff;border-color:var(--cyan);}
.btn-sm.primary:hover{background:var(--cyan-d);}
.output-body{flex:1;padding:30px;display:flex;justify-content:center;}

/* Empty state */
.empty-state{display:flex;flex-direction:column;align-items:center;justify-content:center;text-align:center;min-height:400px;gap:14px;color:#6b8fa3;max-width:360px;margin:auto;}
.empty-icon{font-size:52px;opacity:.35;}
.empty-title{font-size:16px;font-weight:700;color:#3a5a72;}
.empty-desc{font-size:13px;line-height:1.6;}

/* Loading */
.loader{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:400px;gap:14px;margin:auto;}
.spin{width:46px;height:46px;border:4px solid rgba(0,187,214,.2);border-top-color:var(--cyan);border-radius:50%;animation:spin .8s linear infinite;}
@keyframes spin{to{transform:rotate(360deg);}}
.loader-t{font-size:15px;font-weight:600;color:#0d1f2d;}
.loader-s{font-size:12px;color:#6b8fa3;}

/* ‚îÄ‚îÄ Syllabus Document ‚îÄ‚îÄ */
.syldoc{background:#fff;width:100%;max-width:960px;box-shadow:0 4px 40px rgba(0,0,0,0.12);border-radius:4px;font-family:'Plus Jakarta Sans',sans-serif;font-size:12px;color:#1a1a2e;line-height:1.6;}

/* Doc Header */
.syl-hdr{background:#0d1f2d;color:#fff;padding:22px 28px;display:flex;align-items:center;gap:20px;}
.syl-hdr-badge{width:52px;height:52px;background:rgba(0,187,214,0.15);border:2px solid rgba(0,187,214,0.4);border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:24px;flex-shrink:0;}
.syl-hdr-info{flex:1;}
.syl-school{font-size:16px;font-weight:800;font-family:'Space Grotesk',sans-serif;letter-spacing:-0.02em;}
.syl-dept{font-size:12px;color:rgba(255,255,255,0.7);margin-top:1px;}
.syl-program{font-size:11px;color:rgba(0,187,214,0.9);font-weight:600;margin-top:2px;}
.syl-tag{background:rgba(0,187,214,0.2);border:1px solid rgba(0,187,214,0.35);padding:4px 12px;border-radius:20px;font-size:11px;font-weight:700;color:rgba(255,255,255,0.9);align-self:flex-start;}

/* Title Banner */
.syl-banner{background:linear-gradient(135deg,#00bbd6 0%,#0d4a6e 100%);padding:16px 28px;display:flex;align-items:center;gap:16px;}
.syl-banner-code{font-family:'Space Grotesk',sans-serif;font-size:22px;font-weight:800;color:#fff;letter-spacing:-0.03em;white-space:nowrap;}
.syl-banner-sep{width:2px;height:36px;background:rgba(255,255,255,0.3);flex-shrink:0;}
.syl-banner-title{font-family:'Space Grotesk',sans-serif;font-size:16px;font-weight:700;color:#fff;opacity:.95;}
.syl-banner-label{font-size:10px;text-transform:uppercase;letter-spacing:.06em;color:rgba(255,255,255,0.65);font-weight:600;}

/* Info Grid */
.syl-info{padding:18px 28px;border-bottom:1px solid #e8eef2;}
.syl-info-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:0;border:1px solid #d5e3ea;border-radius:8px;overflow:hidden;}
.syl-info-cell{padding:10px 14px;border-right:1px solid #d5e3ea;border-bottom:1px solid #d5e3ea;}
.syl-info-cell:nth-child(3n){border-right:none;}
.syl-info-cell:nth-last-child(-n+3){border-bottom:none;}
.syl-info-cell:nth-last-child(-n+3):not(:nth-last-child(-n+3):nth-child(3n+1)):not(:nth-last-child(-n+3):nth-child(3n)){border-bottom:none;}
.sic-lbl{font-size:9px;font-weight:700;text-transform:uppercase;letter-spacing:.06em;color:#6b8fa3;margin-bottom:2px;}
.sic-val{font-size:12px;font-weight:600;color:#0d1f2d;}
.sic-val.empty{color:#aab8c2;font-style:italic;font-weight:400;}

/* Sections */
.syl-section{padding:16px 28px;border-bottom:1px solid #e8eef2;}
.syl-section:last-child{border-bottom:none;}
.syl-sec-hdr{font-family:'Space Grotesk',sans-serif;font-size:12px;font-weight:800;text-transform:uppercase;letter-spacing:.07em;color:#00bbd6;margin-bottom:10px;padding-bottom:6px;border-bottom:2px solid rgba(0,187,214,0.15);display:flex;align-items:center;gap:8px;}
.syl-sec-hdr::before{content:'';width:3px;height:14px;background:var(--cyan);border-radius:2px;flex-shrink:0;}
.syl-sec-body{font-size:12px;line-height:1.75;color:#2a3a4a;}

/* Tables */
.syl-table{width:100%;border-collapse:collapse;font-size:11.5px;margin-top:6px;}
.syl-table th{background:#0d1f2d;color:#fff;padding:8px 10px;text-align:left;font-weight:700;font-family:'Space Grotesk',sans-serif;font-size:10px;text-transform:uppercase;letter-spacing:.04em;}
.syl-table td{padding:8px 10px;border-bottom:1px solid #e8eef2;vertical-align:top;color:#2a3a4a;}
.syl-table tr:nth-child(even) td{background:#f7fafc;}
.syl-table tr:last-child td{border-bottom:none;}
.syl-table .co-code{font-weight:700;color:#0d1f2d;white-space:nowrap;font-family:'Space Grotesk',sans-serif;}
.syl-table .po-map{display:flex;flex-wrap:wrap;gap:3px;}
.syl-table .po-chip{background:rgba(0,187,214,0.1);border:1px solid rgba(0,187,214,0.3);border-radius:4px;padding:1px 6px;font-size:10px;font-weight:700;color:#0d7a8a;white-space:nowrap;}

/* Course Plan table wrapper */
.syl-plan-wrap{overflow-x:auto;margin-top:6px;}
.syl-plan-table{width:100%;border-collapse:collapse;font-size:11px;min-width:900px;}
.syl-plan-table th{background:#0d1f2d;color:#fff;padding:8px 10px;text-align:left;font-weight:700;font-family:'Space Grotesk',sans-serif;font-size:10px;text-transform:uppercase;letter-spacing:.04em;white-space:nowrap;}
.syl-plan-table td{padding:8px 10px;border-bottom:1px solid #e8eef2;border-right:1px solid #f0f5f7;vertical-align:top;color:#2a3a4a;line-height:1.55;}
.syl-plan-table tr:nth-child(even) td{background:#f7fafc;}
.syl-plan-table tr:last-child td{border-bottom:none;}
.syl-plan-table .wk-num{font-family:'Space Grotesk',sans-serif;font-size:13px;font-weight:800;color:#00bbd6;text-align:center;white-space:nowrap;}
.syl-plan-table .topic-cell{font-weight:600;color:#0d1f2d;}

/* Grading table */
.syl-grade-table{width:100%;border-collapse:collapse;font-size:12px;max-width:480px;}
.syl-grade-table th{background:#0d1f2d;color:#fff;padding:8px 12px;text-align:left;font-size:11px;text-transform:uppercase;letter-spacing:.04em;font-family:'Space Grotesk',sans-serif;}
.syl-grade-table td{padding:8px 12px;border-bottom:1px solid #e8eef2;}
.syl-grade-table .wt{font-family:'Space Grotesk',sans-serif;font-size:16px;font-weight:800;color:#00bbd6;}
.syl-grade-total td{background:#0d1f2d;color:#fff;font-weight:700;border-bottom:none;}
.syl-grade-total .wt{color:#faa32b;font-size:16px;}

/* Rubric */
.syl-rubric-table{width:100%;border-collapse:collapse;font-size:11px;}
.syl-rubric-table th{padding:8px 10px;text-align:center;font-weight:700;font-family:'Space Grotesk',sans-serif;font-size:10px;text-transform:uppercase;letter-spacing:.04em;background:#0d1f2d;color:#fff;}
.syl-rubric-table th:first-child{text-align:left;background:#0d2a3d;}
.syl-rubric-table td{padding:8px 10px;border-bottom:1px solid #e8eef2;border-right:1px solid #f0f5f7;vertical-align:top;font-size:11px;line-height:1.5;}
.syl-rubric-table .crit-cell{font-weight:700;color:#0d1f2d;min-width:100px;}
.syl-rubric-table .exc{background:rgba(0,184,148,.05);}
.syl-rubric-table .sat{background:rgba(0,187,214,.04);}
.syl-rubric-table .dev{background:rgba(250,163,43,.04);}
.syl-rubric-table .beg{background:rgba(231,76,60,.04);}
.score-badge{display:inline-block;background:#0d1f2d;color:#fff;border-radius:4px;padding:1px 6px;font-size:10px;font-weight:700;margin-right:4px;}
.score-badge.s4{background:#00b894;}
.score-badge.s3{background:#00bbd6;}
.score-badge.s2{background:#faa32b;}
.score-badge.s1{background:#e74c3c;}

/* References */
.syl-refs{padding:0;list-style:none;}
.syl-refs li{padding:4px 0 4px 16px;position:relative;font-size:12px;line-height:1.6;border-bottom:1px solid #f5f5f5;color:#2a3a4a;}
.syl-refs li::before{content:'‚Ä∫';position:absolute;left:0;color:#00bbd6;font-weight:700;}
.syl-refs li:last-child{border-bottom:none;}
.syl-refs-sub{font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.05em;color:#6b8fa3;margin:10px 0 4px;}

/* Signature */
.syl-sig{display:grid;grid-template-columns:1fr 1fr;gap:30px;padding:24px 28px;background:#f9fbfc;border-top:2px solid #e8eef2;}
.syl-sig-box{text-align:center;}
.syl-sig-line{border-bottom:2px solid #0d1f2d;margin:0 20px 6px;height:40px;}
.syl-sig-name{font-size:11px;font-weight:700;color:#0d1f2d;margin-bottom:2px;}
.syl-sig-role{font-size:10px;color:#6b8fa3;text-transform:uppercase;letter-spacing:.04em;}

/* Misc */
.syl-note{background:#fff8ed;border-left:3px solid #faa32b;padding:10px 14px;border-radius:0 8px 8px 0;font-size:11.5px;color:#5a4310;line-height:1.55;margin:8px 0;}
.syl-reqs-list{padding-left:16px;margin:0;}
.syl-reqs-list li{padding:3px 0;font-size:12px;color:#2a3a4a;line-height:1.6;}

/* Error toast */
.toast{position:fixed;bottom:24px;left:50%;transform:translateX(-50%) translateY(80px);background:#e74c3c;color:#fff;padding:10px 20px;border-radius:10px;font-size:13px;font-weight:600;z-index:999;transition:transform .3s;box-shadow:0 6px 24px rgba(0,0,0,.2);}
.toast.show{transform:translateX(-50%) translateY(0);}
.warn-note{background:rgba(250,163,43,0.1);border:1px solid rgba(250,163,43,0.3);border-radius:8px;padding:8px 12px;font-size:11px;color:#c97d00;margin-top:8px;}

/* ‚îÄ‚îÄ Print ‚îÄ‚îÄ */
@media print{
  body{overflow:visible;}
  .nav,.form-panel,.output-toolbar{display:none!important;}
  .layout{display:block;height:auto;}
  .output-panel{overflow:visible;background:#fff;}
  .output-body{padding:0;display:block;}
  .syldoc{box-shadow:none;border-radius:0;max-width:100%;}
  .empty-state,.loader{display:none;}
  @page{margin:10mm; size:A4;}
  @page :first{margin-top:0;}
  .syl-plan-wrap{overflow-x:visible;}
  .syl-plan-table{min-width:unset;font-size:9px;}
  .syl-plan-table th,.syl-plan-table td{padding:5px 6px;}
  .syl-section{padding:10px 16px;}
  .syl-hdr,.syl-banner{-webkit-print-color-adjust:exact;print-color-adjust:exact;}
}

@media(max-width:768px){
  body{overflow:auto;}
  .layout{flex-direction:column;height:auto;overflow:visible;}
  .form-panel{width:100%;min-width:unset;height:auto;overflow:visible;}
  .output-panel{min-height:600px;}
  .output-body{padding:12px;}
}
</style>
</head>
<body>

<!-- ‚îÄ‚îÄ Navigation ‚îÄ‚îÄ -->
<div class="nav">
  <a href="{{ url_for('landing') }}" class="nav-brand">SKOOLED<span>-AI</span></a>
  <div class="nav-links">
    <a href="{{ turl('generator') }}">Lesson Generator</a>
    <span class="sep">|</span>
    <a href="{{ turl('activities') }}">Activities</a>
    <span class="sep">|</span>
    <a href="{{ turl('syllabus') }}" class="active">Syllabus</a>
    <span class="sep">|</span>
    {% if session.get('user_role') == 'admin' %}
    <a href="{{ turl('auth.admin_panel') }}">Admin</a>
    <span class="sep">|</span>
    {% endif %}
    <a href="{{ url_for('auth.logout') }}">Logout</a>
    <span class="nav-user">{{ session.get('user_name','') }}</span>
  </div>
</div>

<div class="layout">

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     FORM PANEL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="form-panel">
<div class="form-inner">
  <div class="form-title">Syllabus Generator</div>
  <div class="form-sub">OBE-aligned syllabi for SHS &amp; College</div>

  <!-- Institution Type -->
  <div class="fs">
    <div class="fs-hdr">Institution Type</div>
    <div class="type-tabs">
      <div class="type-tab on" data-type="college" id="tab-college">College / University</div>
      <div class="type-tab" data-type="shs" id="tab-shs">Senior High School</div>
    </div>
    <input type="hidden" id="institution-type" value="college">
  </div>

  <!-- School & Program -->
  <div class="fs">
    <div class="fs-hdr">School &amp; Program</div>
    <div class="fg">
      <label>School / University Name</label>
      <input type="text" id="school-name" placeholder="e.g. De La Salle-College of Saint Benilde">
    </div>
    <div class="fg">
      <label>College / Department</label>
      <input type="text" id="college-dept" placeholder="e.g. School of New Media Arts">
    </div>
    <div class="fg">
      <label>Program</label>
      <input type="text" id="program" placeholder="e.g. Bachelor of Arts in Multimedia Arts">
    </div>
  </div>

  <!-- Course Details -->
  <div class="fs">
    <div class="fs-hdr">Course Details</div>
    <div class="fr2">
      <div class="fg">
        <label>Course Code</label>
        <input type="text" id="course-code" placeholder="e.g. MELPRIN">
      </div>
      <div class="fg">
        <label>Credit Units</label>
        <input type="text" id="credits" placeholder="e.g. 3 units">
      </div>
    </div>
    <div class="fg">
      <label>Course Title *</label>
      <input type="text" id="course-title" placeholder="e.g. Elements and Principles of Design">
    </div>
    <div class="fg">
      <label>Prerequisites</label>
      <input type="text" id="prerequisites" placeholder="e.g. None / Course Code">
    </div>
    <div class="fr2">
      <div class="fg">
        <label>Course Type</label>
        <select id="course-type">
          <option value="Core">Core</option>
          <option value="Major">Major</option>
          <option value="Elective">Elective</option>
          <option value="Service">Service / GE</option>
          <option value="Applied Subject">Applied Subject (SHS)</option>
          <option value="Core Subject">Core Subject (SHS)</option>
          <option value="Specialized">Specialized (SHS)</option>
        </select>
      </div>
      <div class="fg">
        <label>No. of Weeks</label>
        <select id="num-weeks">
          <option value="12">12 weeks</option>
          <option value="13">13 weeks</option>
          <option value="14" selected>14 weeks</option>
          <option value="15">15 weeks</option>
          <option value="16">16 weeks</option>
          <option value="18">18 weeks</option>
        </select>
      </div>
    </div>
    <div class="fg">
      <label>Semester / Term</label>
      <input type="text" id="semester" placeholder="e.g. 2nd Semester, AY 2025-2026">
    </div>
  </div>

  <!-- Course Description -->
  <div class="fs">
    <div class="fs-hdr">Course Description</div>
    <div class="fg">
      <textarea id="course-description" rows="4" placeholder="Enter the course description (2‚Äì4 sentences describing what the course covers, its approach, and who it is for)..."></textarea>
    </div>
  </div>

  <!-- Program Outcomes -->
  <div class="fs">
    <div class="fs-hdr">Program Outcomes</div>
    <div class="fg">
      <textarea id="program-outcomes" rows="5" placeholder="Enter one Program Outcome per line&#10;e.g.&#10;Apply knowledge of design principles in professional contexts&#10;Communicate design concepts effectively across media&#10;Demonstrate ethical and socially responsible practice"></textarea>
      <div class="hint">One outcome per line. Will be numbered PO1, PO2, PO3‚Ä¶</div>
    </div>
  </div>

  <!-- Course Outcomes -->
  <div class="fs">
    <div class="fs-hdr">Course Outcomes</div>
    <div class="fg">
      <textarea id="course-outcomes" rows="5" placeholder="Enter one Course Outcome per line&#10;e.g.&#10;Identify the fundamental elements and principles of design&#10;Analyze design compositions using formal critique frameworks&#10;Create original design outputs applying learned principles&#10;Evaluate peer work constructively using design criteria"></textarea>
      <div class="hint">One outcome per line (4‚Äì8 recommended). Will be numbered CO1, CO2, CO3‚Ä¶</div>
    </div>
  </div>

  <!-- Grading -->
  <div class="fs">
    <div class="fs-hdr">Grading Breakdown</div>
    <div id="grading-rows">
      <div class="grading-row">
        <input type="text" class="g-comp" placeholder="Component name" value="Activities">
        <input type="number" class="g-wt" min="0" max="100" value="30" placeholder="%">
      </div>
      <div class="grading-row">
        <input type="text" class="g-comp" placeholder="Component name" value="Projects">
        <input type="number" class="g-wt" min="0" max="100" value="30" placeholder="%">
      </div>
      <div class="grading-row">
        <input type="text" class="g-comp" placeholder="Component name" value="Final Project">
        <input type="number" class="g-wt" min="0" max="100" value="40" placeholder="%">
      </div>
    </div>
    <div class="grading-total ok" id="grading-total">Total: 100% ‚úì</div>
    <div class="hint" style="margin-top:6px;">Weights must add up to 100%</div>
  </div>

  <!-- AI Settings -->
  <div class="fs">
    <div class="fs-hdr">AI Settings</div>
    <label class="ai-toggle" id="ai-toggle">
      <span class="ai-toggle-ico">‚ú®</span>
      <span class="ai-toggle-lbl">Use AI to Generate Content</span>
      <label class="sw"><input type="checkbox" id="use-ai"><span class="sl"></span></label>
    </label>
    <div class="ai-fields" id="ai-fields">
      <div class="fg">
        <label>AI Provider</label>
        <select id="ai-provider">
          <option value="anthropic">Anthropic (Claude)</option>
          <option value="openai">OpenAI (GPT-4o)</option>
        </select>
      </div>
      <div class="fg">
        <label>API Key</label>
        <input type="password" id="api-key" placeholder="sk-ant-... or sk-...">
        <div class="hint">Stored locally in your browser only.</div>
      </div>
    </div>
    <div class="warn-note" id="no-ai-note">Without AI, a structured template with placeholder content will be generated. Enable AI for a fully written syllabus.</div>
  </div>
</div><!-- /form-inner -->

<div class="form-foot">
  <button class="btn-gen" id="btn-generate">Generate Syllabus</button>
</div>
</div><!-- /form-panel -->


<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     OUTPUT PANEL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="output-panel" id="output-panel">
  <div class="output-toolbar">
    <h3 id="out-title">Generated Syllabus</h3>
    <div class="ot-btns">
      <button class="btn-sm primary" id="btn-print" style="display:none" onclick="window.print()">Print / Save PDF</button>
    </div>
  </div>
  <div class="output-body" id="output-body">
    <div class="empty-state">
      <div class="empty-icon">üìã</div>
      <div class="empty-title">Your syllabus will appear here</div>
      <div class="empty-desc">Fill in the form on the left and click <strong>Generate Syllabus</strong> to create a complete OBE-aligned course syllabus ready to print.</div>
    </div>
  </div>
</div>

</div><!-- /layout -->

<div class="toast" id="toast"></div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
     JAVASCRIPT
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<script>
const AUTH_TOKEN = document.querySelector('meta[name="auth-token"]').content;

function apiUrl(path){
  return AUTH_TOKEN ? path+'?_t='+encodeURIComponent(AUTH_TOKEN) : path;
}

// ‚îÄ‚îÄ Settings Persistence ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function saveSettings(){
  const useAI = document.getElementById('use-ai').checked;
  const provider = document.getElementById('ai-provider').value;
  const apiKey = document.getElementById('api-key').value;
  localStorage.setItem('sa_use_ai', useAI ? '1' : '0');
  localStorage.setItem('sa_ai_provider', provider);
  if(apiKey) localStorage.setItem('sa_api_key', apiKey);
}

function loadSettings(){
  const useAI = localStorage.getItem('sa_use_ai') === '1';
  document.getElementById('use-ai').checked = useAI;
  toggleAIFields(useAI);
  const p = localStorage.getItem('sa_ai_provider');
  if(p) document.getElementById('ai-provider').value = p;
  const k = localStorage.getItem('sa_api_key');
  if(k) document.getElementById('api-key').value = k;
}

function toggleAIFields(on){
  document.getElementById('ai-fields').classList.toggle('on', on);
  document.getElementById('ai-toggle').classList.toggle('on', on);
  document.getElementById('no-ai-note').style.display = on ? 'none' : 'block';
}

document.getElementById('use-ai').addEventListener('change', function(){
  toggleAIFields(this.checked);
});

// ‚îÄ‚îÄ Institution Type Toggle ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
document.querySelectorAll('.type-tab').forEach(tab => {
  tab.addEventListener('click', function(){
    document.querySelectorAll('.type-tab').forEach(t => t.classList.remove('on'));
    this.classList.add('on');
    document.getElementById('institution-type').value = this.dataset.type;
  });
});

// ‚îÄ‚îÄ Grading Total ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function updateGradingTotal(){
  let total = 0;
  document.querySelectorAll('.g-wt').forEach(el => total += parseInt(el.value||0));
  const el = document.getElementById('grading-total');
  el.textContent = 'Total: ' + total + '%' + (total===100 ? ' ‚úì' : ' ‚úó (must be 100%)');
  el.className = 'grading-total ' + (total===100 ? 'ok' : 'err');
}
document.addEventListener('input', e => { if(e.target.classList.contains('g-wt')) updateGradingTotal(); });

// ‚îÄ‚îÄ Generate ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
document.getElementById('btn-generate').addEventListener('click', async function(){
  // Validate
  const courseTitle = document.getElementById('course-title').value.trim();
  if(!courseTitle){ showToast('Course Title is required'); return; }

  let total = 0;
  document.querySelectorAll('.g-wt').forEach(el => total += parseInt(el.value||0));
  if(total !== 100){ showToast('Grading weights must add up to 100%'); return; }

  // Build grading object
  const grading = {};
  const rows = document.querySelectorAll('#grading-rows .grading-row');
  rows.forEach(row => {
    const comp = row.querySelector('.g-comp').value.trim();
    const wt = parseInt(row.querySelector('.g-wt').value||0);
    if(comp && wt > 0) grading[comp] = wt;
  });

  // Save AI settings
  saveSettings();

  // Build payload
  const payload = {
    institution_type: document.getElementById('institution-type').value,
    school_name: document.getElementById('school-name').value.trim(),
    college_dept: document.getElementById('college-dept').value.trim(),
    program: document.getElementById('program').value.trim(),
    course_code: document.getElementById('course-code').value.trim(),
    course_title: courseTitle,
    credits: document.getElementById('credits').value.trim(),
    prerequisites: document.getElementById('prerequisites').value.trim() || 'None',
    course_type: document.getElementById('course-type').value,
    semester: document.getElementById('semester').value.trim(),
    num_weeks: parseInt(document.getElementById('num-weeks').value),
    course_description: document.getElementById('course-description').value.trim(),
    program_outcomes: document.getElementById('program-outcomes').value.trim(),
    course_outcomes: document.getElementById('course-outcomes').value.trim(),
    grading: grading,
    use_ai: document.getElementById('use-ai').checked,
    api_key: document.getElementById('api-key').value.trim(),
    ai_provider: document.getElementById('ai-provider').value,
  };

  // Show loader
  const body = document.getElementById('output-body');
  const title = document.getElementById('out-title');
  const printBtn = document.getElementById('btn-print');
  body.innerHTML = `<div class="loader"><div class="spin"></div><div class="loader-t">Generating syllabus...</div><div class="loader-s">This may take up to 30 seconds with AI enabled</div></div>`;
  printBtn.style.display = 'none';
  this.disabled = true;
  title.textContent = 'Generating...';

  try {
    const resp = await fetch(apiUrl('/api/generate-syllabus'), {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify(payload)
    });
    const data = await resp.json();
    if(data.error){ showToast(data.error); body.innerHTML=`<div class="empty-state"><div class="empty-icon">‚ö†Ô∏è</div><div class="empty-title">Generation Failed</div><div class="empty-desc">${esc(data.error)}</div></div>`; return; }

    if(data.warning){
      showToast('Note: ' + data.warning, 5000);
    }

    // Save to localStorage for later
    localStorage.setItem('skooled_syllabus', JSON.stringify(data.syllabus));

    // Render
    body.innerHTML = renderSyllabus(data.syllabus);
    title.textContent = (data.syllabus.course_code||'') + ' ‚Äî ' + (data.syllabus.course_title||'Syllabus');
    printBtn.style.display = '';
  } catch(e){
    showToast('Network error: ' + e.message);
    body.innerHTML = `<div class="empty-state"><div class="empty-icon">‚ö†Ô∏è</div><div class="empty-title">Error</div><div class="empty-desc">${esc(e.message)}</div></div>`;
  } finally {
    this.disabled = false;
  }
});

// ‚îÄ‚îÄ Rendering ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function esc(s){ return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }
function nl2p(s){ return s ? s.split(/\n+/).filter(l=>l.trim()).map(l=>`<p style="margin:0 0 6px">${esc(l.trim())}</p>`).join('') : ''; }
function nl2li(s){ return s ? s.split(/\n+/).filter(l=>l.trim()).map(l=>`<li>${esc(l.trim())}</li>`).join('') : ''; }

function renderSyllabus(s){
  return `<div class="syldoc">
    ${renderHeader(s)}
    ${renderBanner(s)}
    ${renderInfoGrid(s)}
    ${renderDescription(s)}
    ${renderPOs(s)}
    ${renderCOs(s)}
    ${renderCourseStructure(s)}
    ${renderCoursePlan(s)}
    ${renderRequirements(s)}
    ${renderGrading(s)}
    ${renderPolicies(s)}
    ${renderRubric(s)}
    ${renderReferences(s)}
    ${renderSignatures(s)}
  </div>`;
}

function renderHeader(s){
  const typeLabel = s.institution_type === 'shs' ? 'Senior High School' : 'Higher Education Institution';
  return `<div class="syl-hdr">
    <div class="syl-hdr-badge">üéì</div>
    <div class="syl-hdr-info">
      <div class="syl-school">${esc(s.school_name||'[School / University Name]')}</div>
      <div class="syl-dept">${esc(s.college_dept||'[College / Department]')}</div>
      <div class="syl-program">${esc(s.program||'[Program]')}</div>
    </div>
    <div class="syl-tag">${esc(typeLabel)}</div>
  </div>`;
}

function renderBanner(s){
  return `<div class="syl-banner">
    <div>
      <div class="syl-banner-label">Course Code</div>
      <div class="syl-banner-code">${esc(s.course_code||'‚Äî')}</div>
    </div>
    <div class="syl-banner-sep"></div>
    <div>
      <div class="syl-banner-label">Course Title</div>
      <div class="syl-banner-title">${esc(s.course_title||'‚Äî')}</div>
    </div>
  </div>`;
}

function renderInfoGrid(s){
  const cells = [
    ['Credit Units', s.credits||'‚Äî'],
    ['Prerequisites', s.prerequisites||'None'],
    ['Course Type', s.course_type||'‚Äî'],
    ['Academic Period', s.semester||'‚Äî'],
    ['Faculty', s.faculty||'___________________________'],
    ['Schedule', s.schedule||'___________________________'],
  ];
  const cellsHtml = cells.map(([l,v])=>`<div class="syl-info-cell"><div class="sic-lbl">${l}</div><div class="sic-val${v.includes('___')||!v||v==='‚Äî'?' empty':''}">${esc(v)}</div></div>`).join('');
  return `<div class="syl-info"><div class="syl-info-grid">${cellsHtml}</div></div>`;
}

function renderDescription(s){
  if(!s.course_description) return '';
  return `<div class="syl-section"><div class="syl-sec-hdr">Course Description</div><div class="syl-sec-body">${nl2p(s.course_description)}</div></div>`;
}

function renderPOs(s){
  if(!s.program_outcomes||!s.program_outcomes.length) return '';
  const rows = s.program_outcomes.map(po=>`<tr><td class="co-code">${esc(po.code)}</td><td>${esc(po.description)}</td></tr>`).join('');
  return `<div class="syl-section">
    <div class="syl-sec-hdr">Program Outcomes</div>
    <table class="syl-table">
      <thead><tr><th style="width:70px">Code</th><th>Outcome Statement</th></tr></thead>
      <tbody>${rows}</tbody>
    </table>
  </div>`;
}

function renderCOs(s){
  if(!s.course_outcomes||!s.course_outcomes.length) return '';
  const rows = s.course_outcomes.map(co=>{
    const poChips = (co.po_mapping||[]).map(p=>`<span class="po-chip">${esc(p)}</span>`).join('');
    return `<tr><td class="co-code">${esc(co.code)}</td><td>${esc(co.description)}</td><td><div class="po-map">${poChips||'<span style="color:#aab8c2;font-style:italic;font-size:10px">‚Äî</span>'}</div></td></tr>`;
  }).join('');
  return `<div class="syl-section">
    <div class="syl-sec-hdr">Course Outcomes</div>
    <table class="syl-table">
      <thead><tr><th style="width:55px">Code</th><th>Course Outcome Statement</th><th style="width:120px">Program Outcome Mapping</th></tr></thead>
      <tbody>${rows}</tbody>
    </table>
  </div>`;
}

function renderCourseStructure(s){
  let html = '<div class="syl-section"><div class="syl-sec-hdr">Course Structure &amp; Requirements</div>';
  if(s.technology_requirements){
    html += `<div class="syl-sec-body" style="margin-bottom:12px"><strong>Technology Requirements</strong><br>${nl2p(s.technology_requirements)}</div>`;
  }
  if(s.communication_guidelines){
    html += `<div class="syl-sec-body" style="margin-bottom:12px"><strong>Communication Guidelines</strong><br>${nl2p(s.communication_guidelines)}</div>`;
  }
  if(s.submission_protocol){
    html += `<div class="syl-sec-body"><strong>Submission Protocol</strong><br>${nl2p(s.submission_protocol)}</div>`;
  }
  html += '</div>';
  return html;
}

function renderCoursePlan(s){
  if(!s.course_plan||!s.course_plan.length) return '';
  const rows = s.course_plan.map(w=>`
    <tr>
      <td class="wk-num">${esc(String(w.week||''))}</td>
      <td class="topic-cell">${esc(w.topics||'')}</td>
      <td>${esc(w.ilos||'')}</td>
      <td>${esc(w.tlas||'')}</td>
      <td>${esc(w.assessment_tasks||'')}</td>
      <td>${esc(w.evaluation_strategies||'')}</td>
      <td>${esc(w.resources||'')}</td>
      <td style="white-space:nowrap">${esc(w.due_date||'')}</td>
    </tr>`).join('');
  return `<div class="syl-section">
    <div class="syl-sec-hdr">Course Plan</div>
    <div class="syl-plan-wrap">
      <table class="syl-plan-table">
        <thead><tr>
          <th style="width:42px;text-align:center">Week</th>
          <th style="min-width:140px">Topics</th>
          <th style="min-width:170px">Intended Learning Outcomes (ILOs)</th>
          <th style="min-width:140px">Teaching &amp; Learning Activities (TLAs)</th>
          <th style="min-width:130px">Assessment Tasks (ATs)</th>
          <th style="min-width:110px">Evaluation Strategies</th>
          <th style="min-width:130px">Resources</th>
          <th style="min-width:70px">Due Date</th>
        </tr></thead>
        <tbody>${rows}</tbody>
      </table>
    </div>
  </div>`;
}

function renderRequirements(s){
  if(!s.course_requirements||!s.course_requirements.length) return '';
  const items = s.course_requirements.map(r=>`<li>${esc(r)}</li>`).join('');
  return `<div class="syl-section">
    <div class="syl-sec-hdr">Course Requirements &amp; Policies</div>
    <ul class="syl-reqs-list">${items}</ul>
  </div>`;
}

function renderGrading(s){
  if(!s.grading_system||!s.grading_system.length) return '';
  let total = 0;
  const rows = s.grading_system.map(g=>{
    total += parseInt(g.weight||0);
    return `<tr><td>${esc(g.component)}</td><td class="wt">${esc(String(g.weight))}%</td></tr>`;
  }).join('');
  const note = `<div class="syl-note" style="margin-top:10px">The passing grade for this course is <strong>70%</strong>. Grading is cumulative and zero-based. All components must be submitted to receive a final grade.</div>`;
  return `<div class="syl-section">
    <div class="syl-sec-hdr">Grading System</div>
    <table class="syl-grade-table">
      <thead><tr><th>Component</th><th>Weight</th></tr></thead>
      <tbody>${rows}<tr class="syl-grade-total"><td><strong>TOTAL</strong></td><td class="wt">${total}%</td></tr></tbody>
    </table>
    ${note}
  </div>`;
}

function renderPolicies(s){
  return `<div class="syl-section">
    <div class="syl-sec-hdr">Academic Policies</div>
    <div class="syl-sec-body">
      <p style="margin-bottom:8px"><strong>Attendance &amp; Participation:</strong> Students are expected to attend all class sessions. Regular attendance and active participation are integral to learning outcomes. Chronic absences may result in a grade of INC or DRP per institutional policy.</p>
      <p style="margin-bottom:8px"><strong>Academic Honesty:</strong> All outputs submitted must be the original work of the student. Any form of academic dishonesty ‚Äî including plagiarism, fabrication, and unauthorized collaboration ‚Äî will result in a failing grade for the concerned output and may be subject to further disciplinary action in accordance with the school's academic integrity policy.</p>
      <p style="margin-bottom:8px"><strong>Netiquette:</strong> Students must observe proper online etiquette in all digital communications and virtual learning environments. Use of appropriate language and respectful behavior is required in synchronous and asynchronous sessions.</p>
      <p><strong>Intellectual Property:</strong> All course materials provided by the instructor are protected by copyright. Students may not reproduce, distribute, or publish any course materials without prior written consent.</p>
    </div>
  </div>`;
}

function renderRubric(s){
  if(!s.rubric||!s.rubric.criteria||!s.rubric.criteria.length) return '';
  const headers = `<tr>
    <th style="width:120px">Criterion</th>
    <th style="width:60px;text-align:center">Weight</th>
    <th><span class="score-badge s4">4</span> Excellent</th>
    <th><span class="score-badge s3">3</span> Satisfactory</th>
    <th><span class="score-badge s2">2</span> Developing</th>
    <th><span class="score-badge s1">1</span> Beginning</th>
  </tr>`;
  const rows = s.rubric.criteria.map(c=>`<tr>
    <td class="crit-cell">${esc(c.criterion||'')}<br><span style="font-size:10px;color:#6b8fa3;font-weight:400">${esc(c.weight||'')}</span></td>
    <td style="text-align:center;font-weight:700;font-family:'Space Grotesk',sans-serif;color:#0d1f2d">${esc(c.weight||'')}</td>
    <td class="exc">${esc(c.excellent_4||c.excellent||'')}</td>
    <td class="sat">${esc(c.satisfactory_3||c.satisfactory||'')}</td>
    <td class="dev">${esc(c.developing_2||c.developing||'')}</td>
    <td class="beg">${esc(c.beginning_1||c.beginning||'')}</td>
  </tr>`).join('');
  return `<div class="syl-section">
    <div class="syl-sec-hdr">Assessment Rubric ‚Äî ${esc(s.rubric.title||'Course Output Rubric')}</div>
    <div style="overflow-x:auto"><table class="syl-rubric-table"><thead>${headers}</thead><tbody>${rows}</tbody></table></div>
  </div>`;
}

function renderReferences(s){
  if(!s.references) return '';
  const books = (s.references.books||[]).filter(b=>b&&!b.startsWith('['));
  const sites = (s.references.websites||[]).filter(b=>b&&!b.startsWith('['));
  if(!books.length && !sites.length){
    const allBooks = s.references.books||[];
    const allSites = s.references.websites||[];
    if(!allBooks.length && !allSites.length) return '';
  }
  let html = '<div class="syl-section"><div class="syl-sec-hdr">References</div>';
  if((s.references.books||[]).length){
    html += '<div class="syl-refs-sub">Books &amp; Journals</div><ul class="syl-refs">';
    s.references.books.forEach(b=>{ html+=`<li>${esc(b)}</li>`; });
    html += '</ul>';
  }
  if((s.references.websites||[]).length){
    html += '<div class="syl-refs-sub" style="margin-top:12px">Online Resources</div><ul class="syl-refs">';
    s.references.websites.forEach(b=>{ html+=`<li>${esc(b)}</li>`; });
    html += '</ul>';
  }
  html += '</div>';
  return html;
}

function renderSignatures(s){
  return `<div class="syl-sig">
    <div class="syl-sig-box">
      <div class="syl-sig-line"></div>
      <div class="syl-sig-name">[Faculty Name]</div>
      <div class="syl-sig-role">Prepared by ‚Äî Course Instructor</div>
    </div>
    <div class="syl-sig-box">
      <div class="syl-sig-line"></div>
      <div class="syl-sig-name">[Department Head / Dean]</div>
      <div class="syl-sig-role">Approved by ‚Äî Department / Academic Head</div>
    </div>
  </div>`;
}

// ‚îÄ‚îÄ Toast ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function showToast(msg, dur=3500){
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'), dur);
}

// ‚îÄ‚îÄ Init ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
loadSettings();
updateGradingTotal();
</script>
</body>
</html>
